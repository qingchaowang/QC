source("~/GitHub/R/tools/tools.R")
library(readxl)
all_data <- read_xlsx("~/Desktop/xlsx/historical/t24com_pb_data.xlsx")
all_data$rojp_1 <- all_data$rojp_1/1e6
all_data$entries <- all_data$entries/1e6
my_data <- all_data
plot(entries ~ rojp_1, my_data, col = as.factor(day))
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP), col = 1))
ROJP <- seq(40, 500, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP), col = 1))
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP), col = 2))
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
m3 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP)), col = 1, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2, lty = 4)
plot(entries ~ rojp_1, my_data, col = as.factor(day), ylim = c(0,1), xlim = c(0, 1000))
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m3 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP)), col = 1, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2, lty = 4)
m3 <- irls(lm(entries ~ day*(I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3)), my_data, wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), my_data, wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP)), col = 1, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2, lty = 4)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m3 <- irls(lm(entries ~ day*(I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3)), my_data, wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), my_data, wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP)), col = 1, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2, lty = 4)
plot(entries ~ rojp_1, my_data, col = as.factor(day), ylim = c(0,1), xlim = c(0, 1000))
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m3 <- irls(lm(entries ~ day*(I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3)), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
anova(m3, m4)
anova(m4, m3)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Wed")), col = 1, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP, day = "Sat")), col = 2, lty = 4)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Wed")), col = 1, lty = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Sat")), col = 2, lty = 4)
plot(entries ~ rojp_1, my_data, col = as.factor(day), ylim = c(0,1), xlim = c(0, 1000))
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Wed")), col = 1, lty = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Sat")), col = 2, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(m4)
plot(m1)
plot(m2)
my_data$date
my_data$day
factor(my_data$day)
all_data <- read_xlsx("~/Desktop/xlsx/historical/t24com_pb_data.xlsx")
all_data$rojp_1 <- all_data$rojp_1/1e6
all_data$entries <- all_data$entries/1e6
all_data$day <- factor(all_data$day, levels = c("Wed", "Sat"))
my_data <- all_data
my_data <- all_data
plot(entries ~ rojp_1, my_data, col = day, ylim = c(0,1), xlim = c(0, 1000))
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m3 <- irls(lm(entries ~ day*(I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3)), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
plot(entries ~ rojp_1, my_data, col = day)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m3 <- irls(lm(entries ~ day*(I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3)), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Wed")), col = 1, lty = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Sat")), col = 2, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2)
my_data
my_data[1:20]
my_data[1:20,]
my_data[1:21,]
my_data[24,]
my_data <- all_data[-24,]
plot(entries ~ rojp_1, my_data, col = day)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m3 <- irls(lm(entries ~ day*(I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3)), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
m4 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), my_data), wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Wed")), col = 1, lty = 2)
lines(ROJP, predict(m3, newdata = data.frame(rojp_1 = ROJP, day = "Sat")), col = 2, lty = 2)
lines(ROJP, predict(m4, newdata = data.frame(rojp_1 = ROJP)), col = 2)
anova(m4)
anova(m3)
source("~/GitHub/R/tools/tools.R")
library(readxl)
all_data <- read_xlsx("~/Desktop/xlsx/historical/t24com_pb_data.xlsx")
all_data$rojp_1 <- all_data$rojp_1/1e6
all_data$entries <- all_data$entries/1e6
all_data$day <- factor(all_data$day, levels = c("Wed", "Sat"))
my_data <- all_data[-24,]
plot(entries ~ rojp_1, my_data, col = day)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
source("~/GitHub/R/tools/tools.R")
library(readxl)
all_data <- read_xlsx("~/Desktop/xlsx/historical/t24com_pb_data.xlsx")
all_data$rojp_1 <- all_data$rojp_1/1e6
all_data$entries <- all_data$entries/1e6
all_data$day <- factor(all_data$day, levels = c("Wed", "Sat"))
my_data <- all_data[-24,]
plot(entries ~ rojp_1, my_data, col = day)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, col = cycle, my_data)
my_data <- all_data[-c(1:5,24),]
plot(entries ~ rojp_1, my_data, col = day)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2) + I(rojp_1^3), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 1000), ylim = c(0, 1))
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
anova(m1)
anova(m2)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 1000), ylim = c(0, 1))
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
m2
abline(h = m2$coefficients[1])
my_data[(my_data$rojp_1<100)&(my_data$entries > 0.03)]
my_data[(my_data$rojp_1<100)&(my_data$entries > 0.03),]
paste(m1$coefficients, collapse = ", ")
summary(m1)$sigma
paste(m2$coefficients, collapse = ", ")
summary(m2)$sigma
source("~/GitHub/R/tools/tools.R")
library(readxl)
all_data <- read_xlsx("~/Desktop/xlsx/historical/t24com_pb_data.xlsx")
all_data$rojp_1 <- all_data$rojp_1/1e6
all_data$entries <- all_data$entries/1e6
all_data$day <- factor(all_data$day, levels = c("Wed", "Sat"))
my_data <- all_data[-c(1:5,24),]
plot(entries ~ rojp_1, my_data, col = day)
m1 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Wed")), wfunc = function(x){1/x$fit^2}, 0.0000001)
m2 <- irls(lm(entries ~ I(rojp_1 > 0) + rojp_1 + I(rojp_1^2), subset(my_data, day == "Sat")), wfunc = function(x){1/x$fit^2}, 0.0000001)
plot(entries ~ rojp_1, my_data, col = day)
ROJP <- seq(40, 1000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
m1$coefficients
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 20000))
ROJP <- seq(40, 20000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 10000))
ROJP <- seq(40, 20000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 10000), ylim = c(0,1))
ROJP <- seq(40, 20000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 10000), ylim = c(0,10))
ROJP <- seq(40, 20000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 20000), ylim = c(0,10))
ROJP <- seq(40, 20000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
plot(entries ~ rojp_1, my_data, col = day, xlim = c(0, 20000), ylim = c(0,100))
ROJP <- seq(40, 20000, 10)
lines(ROJP, predict(m1, newdata = data.frame(rojp_1 = ROJP)), col = 1)
lines(ROJP, predict(m2, newdata = data.frame(rojp_1 = ROJP)), col = 2)
15000000000/1e6
x <- read.table("~/Desktop/Powerball/rojp_threshold/pbp_sim.txt")
head(x)
x <- x/1e6
mean(x[,2] > 1000)
max(x[,2])
max(x[,2])*1e6
mean(x[,2] > 1000)
getwd
getwd()
